var BoPattern=function(){"use strict";var a=[],b=function(b){var c={label:"Pattern of Life",objects:{background:[],foreground:[],overlay:[]},debug:!1,user:{mousePosition:{x:0,y:0}},data:{}};if("undefined"==typeof window||"undefined"==typeof window.HTMLCanvasElement)throw"[BoPattern.js] Sorry but your browser doesn't support the canvas element!";if(!msngr.exist(b)||msngr.isEmptyString(b))throw"[BoPattern.js] Sorry but you supplied me with invalid input! What do you expect me to do with that!?";switch(msngr.getType(b)){case"[object String]":var d=msngr.findElement(b);"[object HTMLCanvasElement]"!==msngr.getType(d)?(c.canvas=document.createElement("canvas"),d.appendChild(c.canvas)):c.canvas=d;break;case"[object HTMLCanvasElement]":c.canvas=b;break;default:if(!msngr.isHtmlElement(b))throw"[BoPattern.js] Sorry but you supplied me with invalid input! What do you expect me to do with that!?";c.canvas=document.createElement("canvas"),b.appendChild(c.canvas)}if(c.context2D=c.canvas.getContext("2d"),Object.defineProperty(c,"pxRatio",{get:function(){var a=window.devicePixelRatio||1,b=c.context2D.backingStorePixelRatio||c.context2D.webkitBackingStorePixelRatio||c.context2D.mozBackingStorePixelRatio||c.context2D.msBackingStorePixelRatio||c.context2D.backingStorePixelRatio||1;return a/b}}),!msngr.exist(c.canvas)||!msngr.exist(c.context2D))throw"[BoPattern.js] Welp you passed the first set of validators but I still failed to get the canvas :(";c.parent=c.canvas.parentNode,Object.defineProperty(c,"zlevels",{get:function(){return Object.keys(c.objects)}}),c.random=function(a,b){return Math.random()*(b-a)+a},c.addObject=function(a,b){msngr.exist(b)&&msngr.exist(b.render)&&c.objects[a].push(b)},c.clearObjects=function(a,b){for(var d=0;d<c.objects[a].length;++d)void 0!==b&&c.objects[a][d].type===b?c.objects[a][d].unload():void 0===b&&c.objects[a][d].unload()};for(var e={},f=0;f<a.length;++f){var g=a[f];"[object Function]"===Object.prototype.toString.call(g)&&(g=g(c)),e=msngr.merge(g,e)}return Object.defineProperty(e,"debug",{set:function(a){c.debug=a,a===!0&&(c.clearObjects("overlay"),c.addObject("overlay",c.BoDebug()),Object.defineProperty(e,"internal",{configurable:!0,get:function(){return c}})),a===!1&&(c.clearObjects("overlay","bodebug"),delete e.internal)},get:function(){return c.debug}}),Object.defineProperty(e,"label",{get:function(){return c.label},set:function(a){c.label=a}}),c.addObject("overlay",c.BoEmpty()),c.addObject("overlay",c.BoLabel()),document.addEventListener("visibilitychange",function(a){document.hidden?c.stopRendering():c.startRendering()}),e.removeSelf=function(){c.clearObjects("background"),c.clearObjects("foreground"),c.clearObjects("overlay"),c.stopUpdating(),c.stopRendering(),c.parent.removeChild(c.canvas)},e};return b.extend=function(b){a.push(b)},b}();BoPattern.extend(function(a){"use strict";var b,c=function(b,c){for(var d=a.objects[b].length,e=0;d>e;++e)a.objects[b][e]&&(c.beginPath(),a.objects[b][e].render(c),c.closePath())},d=function(){var e=a.context2D;e.clearRect(0,0,a.canvas.width,a.canvas.height),c("background",e),c("foreground",e),c("overlay",e),b=window.requestAnimationFrame(d)};a.startRendering=function(){d()},a.stopRendering=function(){(window.cancelAnimationFrame||window.mozCancelAnimationFrame)(b)},a.startRendering()}),BoPattern.extend(function(a){"use strict";var b=function(b,c){for(var d=a.objects[b].length,e=0;d>e;++e)a.objects[b][e]&&a.objects[b][e].update(c)};a.canvas.addEventListener("mousemove",function(b){var c=a.canvas.getBoundingClientRect();a.user.mousePosition={x:b.clientX-c.left,y:b.clientY-c.top}});var c,d=function(){var e=a.context2D,f=a.pxRatio,g=a.parent.getBoundingClientRect().width,h=a.parent.getBoundingClientRect().height;(a.screenWidth!==g||a.screenHeight!==h)&&(a.canvas.width=g*f,a.canvas.style.width=g+"px",a.screenWidth=g,a.canvas.height=h*f,a.canvas.style.height=h+"px",a.screenHeight=h,e.setTransform(f,0,0,f,0,0),a.boundedWidth=a.screenWidth-.15*a.screenWidth,a.boundedHeight=a.screenHeight-.2*a.screenHeight,a.boundedX1=(a.screenWidth-a.boundedWidth)/2,a.boundedY1=(a.screenHeight-a.boundedHeight)/2+(a.screenHeight-a.boundedHeight)/2/2),b("background",e),b("foreground",e),b("overlay",e),c=window.requestAnimationFrame(d)};a.startUpdating=function(){d()},a.stopUpdating=function(){(window.cancelAnimationFrame||window.mozCancelAnimationFrame)(c)},a.startUpdating()}),BoPattern.extend(function(a){"use strict";return a.BoDebug=function(){var b="overlay",c={mouse:{},tiles:{},data:{}},d=!1,e={type:"bodebug",render:function(b){d&&(b.beginPath(),b.font="10pt Sans-serif",b.fillStyle="black",b.globalAlpha=1,b.textAlign="left",b.fillText(c.tiles.txt,c.tiles.x,c.tiles.y),b.fillText(c.data.txt,c.data.x,c.data.y),b.textAlign="center",b.fillText(c.mouse.txt,c.mouse.x,c.mouse.y),b.closePath()),b.beginPath(),b.strokeStyle="#000000",b.globalAlpha=1,b.lineWidth=1,b.strokeRect(a.boundedX1,a.boundedY1,a.boundedWidth,a.boundedHeight),b.closePath()},update:function(b){c.mouse.txt="X: "+Math.floor(a.user.mousePosition.x)+" Y: "+Math.floor(a.user.mousePosition.y);var e=b.measureText(c.mouse.txt);c.mouse.x=a.screenWidth-e.width,c.mouse.y=15,c.tiles.txt="Tile count: "+a.objects.background.length,c.tiles.x=2,c.tiles.y=15,c.data.txt="min value: "+Math.round(a.data.minValue)+" / max value: "+Math.round(a.data.maxValue),c.data.x=2,c.data.y=30,d=!0},load:function(){},unload:function(){a.objects[b].splice(a.objects[b].indexOf(e),1)}};return Object.defineProperty(e,"z",{get:function(){return b}}),e},{}}),BoPattern.extend(function(a){"use strict";return a.BoEmpty=function(){var b,c,d,e="overlay",f="I have no data to display :(",g={type:"boempty",render:function(a){c&&d&&(a.font="16pt Calibri",a.fillStyle="black",a.fillText(f,c,d))},update:function(e){b=e.measureText(f),c=a.screenWidth/2-b.width,d=a.screenHeight/2-b.height},load:function(){},unload:function(){a.objects[e].splice(a.objects[e].indexOf(g),1)}};return Object.defineProperty(g,"z",{get:function(){return z}}),g},{}}),BoPattern.extend(function(a){"use strict";return a.BoLabel=function(){var b="overlay",c=0,d=0,e={type:"bolabel",render:function(b){b.beginPath(),b.font="16pt sans-serif",b.fillStyle="#000000",b.globalAlpha=1,b.textAlign="left",b.fillText(a.label,c,d),b.closePath()},update:function(b){var e=b.measureText(a.label);c=a.screenWidth/2-e.width,d=a.boundedY1/2},load:function(){},unload:function(){a.objects[b].splice(a.objects[b].indexOf(e),1)}};return Object.defineProperty(e,"z",{get:function(){return b}}),e},{}}),BoPattern.extend(function(a){"use strict";return a.BoTile=function(b){var c="background";if(!msngr.exist(b)||!msngr.exists(b.value,b.label,b.position))throw"[BoPattern.js] Invalid parameters supplied to BoTile";var d,e,f,g,h=!1,i=msngr.copy(b),j={},k=function(){var b=a.boundedWidth/a.data.maxFirstDimension,c=a.boundedHeight/(a.data.maxSecondDimension+1),d=a.boundedX1+b*i.position[0],e=a.boundedY1+c*i.position[1];return{x:d,y:e,width:b,height:c}},l=function(b){return void 0!==j[b]?j[b]:void 0!==i[b]?i[b]:a.BoTile.properties[b]},m={type:"tile",render:function(a){h&&(a.beginPath(),a.strokeStyle=l("borderColor"),a.lineWidth=l("borderThickness"),a.globalAlpha=l("borderAlpha"),a.strokeRect(l("x"),l("y"),l("width"),l("height")),a.closePath(),a.beginPath(),a.fillStyle=l("tileColor"),a.globalAlpha=l("tileAlpha"),a.fillRect(l("x"),l("y"),l("width"),l("height")),a.closePath())},update:function(){if(e=!1,a.user.mousePosition.x>=i.x&&a.user.mousePosition.x<=i.x+i.width&&a.user.mousePosition.y>=i.y&&a.user.mousePosition.y<=i.y+i.height&&(e=!0),f!==a.screenWidth||g!==a.screenHeight){var b=k();i.x=b.x,i.y=b.y,i.width=b.width,i.height=b.height,void 0!==d&&(j.x=i.x,j.y=i.y,j.width=i.width,j.height=i.height),f=a.screenWidth,g=a.screenHeight}if(void 0!==d){if("loading"===d){if(j.tileAlpha>=i.tileAlpha)return d=void 0,void(j={});void 0===j.tileAlpha.toFixed&&console.log(j.tileAlpha),j.tileAlpha=j.tileAlpha+a.random(.02,.04)}if("unloading"===d){if(j.tileAlpha<=0)return d=void 0,j={},void a.objects[c].splice(a.objects[c].indexOf(m),1);j.tileAlpha=j.tileAlpha-a.random(.08,.12)}}},load:function(){d="loading",f=a.screenWidth,g=a.screenHeight;var b=k();i.x=b.x,i.y=b.y,i.width=b.width,i.height=b.height,0===a.data.maxValue?i.tileAlpha=0:i.tileAlpha=i.value/a.data.maxValue,j=msngr.copy(i),j.tileAlpha=0,h=!0},unload:function(){d="unloading",j=msngr.copy(i)}};return Object.defineProperty(m,"z",{get:function(){return c}}),Object.defineProperty(m,"properties",{get:function(){return i}}),m},a.BoTile.properties={tileColor:"#4DD2FF",tileAlpha:1,borderColor:"#FFFFFF",borderThickness:10,borderAlpha:1,borderHighlight:"#A3B3A3"},{}}),BoPattern.extend(function(a){"use strict";return{load:function(b){if(msngr.exist(b)){for(var c=a.objects.background.length,d=0;c>d;++d)a.objects.background[d].unload();var e=function(){if(a.objects.background.length>0)setTimeout(e,5);else{for(var c=void 0,d=void 0,f=b.length,g=void 0,h=[],i=b.length,j=0;i>j;++j)for(var k=b[j].length,l=0;k>l;++l){var m=b[j][l];msngr.isObject(m)?(m.value=m.value||m.data,m.label=m.label||m.value,delete m.data):m={value:m,label:String(m)};var n=a.BoTile(msngr.merge(m,{position:[j,l]}));h.push(n),(void 0===c||m.value<c)&&(c=m.value),(void 0===d||m.value>d)&&(d=m.value),(void 0===g||l>g)&&(g=l)}a.clearObjects("background"),a.data.raw=b,a.stopUpdating(),a.stopRendering(),a.data.minValue=c,a.data.maxValue=d,a.data.maxFirstDimension=f,a.data.maxSecondDimension=g,a.objects.background=h,a.startUpdating(),a.startRendering();for(var o=a.objects.background.length,j=0;o>j;++j)a.objects.background[j].load()}};e()}}}});